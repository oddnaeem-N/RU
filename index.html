<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>MCQ ржЕрзНржпрж╛ржк</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
html, body {margin:0; padding:0; overflow-x:hidden; font-family:"Noto Sans Bengali",sans-serif; background:#f9f9f9;}
.container{max-width:500px; margin:auto; padding:10px;}
.card{width:100%; padding:20px; margin:25px 0; border-radius:12px; background:#fff; border:1px solid #ccc;}
h4{margin-top:20px; margin-bottom:10px;}
.option-btn{width:100%; margin-bottom:10px; font-size:18px; border-radius:8px; transition:0.2s;}
.option-btn:hover{transform:scale(1.03);}
.result{margin-top:15px; font-weight:600; font-size:18px;}
.admin-panel{display:none; margin-top:10px;}
textarea{font-family:monospace; width:100%;}
@media(min-width:576px){.option-btn{font-size:20px;}}
</style>
</head>
<body>

<div class="container">
  <div class="d-flex justify-content-end mt-2 mb-2">
    <button class="btn btn-primary me-2" onclick="showQuiz()">ЁЯОо ржХрзБржЗржЬ</button>
    <button class="btn btn-dark" onclick="showAdmin()">тЪЩя╕П ржЕрзНржпрж╛ржбржорж┐ржи</button>
  </div>

  <!-- Quiz Section -->
  <div id="quizSection">
    <div class="card text-center">
      <div class="card-body">
        <div>
          <select id="categoryFilter" class="form-select mb-3" onchange="applyFilter()">
            <option value="">рж╕ржм ржХрзНржпрж╛ржЯрж╛ржЧрж░рж┐</option>
          </select>
        </div>
        <div id="question" class="mb-3" style="font-size:22px;">рж▓рзЛржб рж╣ржЪрзНржЫрзЗ...</div>
        <div id="options" class="d-grid gap-2">
          <button class="btn btn-outline-primary option-btn" onclick="checkAnswer(this)"></button>
          <button class="btn btn-outline-success option-btn" onclick="checkAnswer(this)"></button>
          <button class="btn btn-outline-warning option-btn" onclick="checkAnswer(this)"></button>
          <button class="btn btn-outline-danger option-btn" onclick="checkAnswer(this)"></button>
        </div>
        <div id="result" class="result"></div>
        <button class="btn btn-secondary mt-3" onclick="nextQuestion()">ржкрж░рзЗрж░ ржкрзНрж░рж╢рзНржи</button>
      </div>
    </div>
  </div>

  <!-- Admin Panel -->
  <div id="adminPanel" class="admin-panel">
    <h4>ЁЯУЭ ржкрзНрж░рж╢рзНржи ржУ ржЕржкрж╢ржи ржорзНржпрж╛ржирзЗржЬржорзЗржирзНржЯ</h4>

    <!-- Option Management -->
    <div class="card mb-3">
      <div class="card-body">
        <h5>ржкрзНрж░рж┐-ржорзЗржб ржЕржкрж╢ржи рждрзИрж░рж┐ ржХрж░рзБржи</h5>
        <input id="optionText" class="form-control mb-2" placeholder="ржирждрзБржи ржЕржкрж╢ржи">
        <div class="d-grid"><button class="btn btn-success" onclick="addOption()">ржЕржкрж╢ржи ржпрзЛржЧ ржХрж░рзБржи</button></div>
        <label class="mt-3">ржмрж┐ржжрзНржпржорж╛ржи ржЕржкрж╢ржи:</label>
        <select id="existingOptions" class="form-select mb-2" size="5"></select>
        <div class="d-grid"><button class="btn btn-danger" onclick="deleteOption()">ржбрж┐рж▓рж┐ржЯ ржЕржкрж╢ржи</button></div>
      </div>
    </div>

    <!-- Question Management -->
    <div class="card mb-3">
      <div class="card-body">
        <h5>ржкрзНрж░рж╢рзНржи ржпрзЛржЧ ржХрж░рзБржи</h5>
        <input id="questionText" class="form-control mb-2" placeholder="ржкрзНрж░рж╢рзНржи">
        <input id="correctAnswer" class="form-control mb-2" placeholder="рж╕ржарж┐ржХ ржЙрждрзНрждрж░">
        <label>ржнрзБрж▓ ржЕржкрж╢ржи рж╕рж┐рж▓рзЗржХрзНржЯ ржХрж░рзБржи (рзйржЯрж┐):</label>
        <select id="wrongOptions" class="form-select mb-2" multiple style="height:120px;"></select>
        <input id="category" class="form-control mb-2" placeholder="ржХрзНржпрж╛ржЯрж╛ржЧрж░рж┐">
        <div class="d-grid"><button class="btn btn-primary" onclick="addQuestion()">ржкрзНрж░рж╢рзНржи ржпрзЛржЧ ржХрж░рзБржи</button></div>
      </div>
    </div>

    <!-- Question Table -->
    <h4>ржкрзНрж░рж╢рзНржи рждрж╛рж▓рж┐ржХрж╛</h4>
    <table class="table table-bordered" id="questionsTable">
      <thead class="table-dark"><tr><th>#</th><th>ржкрзНрж░рж╢рзНржи</th><th>рж╕ржарж┐ржХ ржЙрждрзНрждрж░</th><th>ржХрзНржпрж╛ржЯрж╛ржЧрж░рж┐</th><th>рж╕рзНржЯрзНрж░рж┐ржХ</th><th>ржЕрзНржпрж╛ржХрж╢ржи</th></tr></thead>
      <tbody></tbody>
    </table>

    <!-- JSON Section -->
    <h4>JSON ржХржкрж┐</h4>
    <button class="btn btn-info mb-2" onclick="toggleJson()">ЁЯУД JSON ржжрзЗржЦрзБржи</button>
    <div id="jsonBox" style="display:none;">
      <textarea id="jsonView" rows="10" readonly></textarea>
      <button class="btn btn-secondary mt-2" onclick="copyJson()">Copy JSON</button>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
// ================== ржбрж┐ржлрж▓рзНржЯ ржбрзЗржЯрж╛ ==================
let defaultOptions=["ржврж╛ржХрж╛","ржЪржЯрзНржЯржЧрзНрж░рж╛ржо","ржЦрзБрж▓ржирж╛","рж╕рж┐рж▓рзЗржЯ","ржкрзВрж░рзНржм","ржкрж╢рзНржЪрж┐ржо","ржЙрждрзНрждрж░","ржжржХрзНрж╖рж┐ржг"];
let defaultQuestions=[
  {question:"ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗрж░ рж░рж╛ржЬржзрж╛ржирзА ржХрзЛржерж╛рзЯ?",options:["ржврж╛ржХрж╛","ржЪржЯрзНржЯржЧрзНрж░рж╛ржо","ржЦрзБрж▓ржирж╛","рж╕рж┐рж▓рзЗржЯ"],answer:"ржврж╛ржХрж╛",category:"ржмрж╛ржВрж▓рж╛ржжрзЗрж╢",streak:0},
  {question:"рж╕рзВрж░рзНржп ржХрзЛржерж╛рзЯ ржЙржжрзЯ рж╣рзЯ?",options:["ржкрзВрж░рзНржм","ржкрж╢рзНржЪрж┐ржо","ржЙрждрзНрждрж░","ржжржХрзНрж╖рж┐ржг"],answer:"ржкрзВрж░рзНржм",category:"рж╕рж╛ржзрж╛рж░ржг ржЬрзНржЮрж╛ржи",streak:0}
];

if(!localStorage.getItem("mcqData")) localStorage.setItem("mcqData", JSON.stringify(defaultQuestions));
if(!localStorage.getItem("mcqOptions")) localStorage.setItem("mcqOptions", JSON.stringify(defaultOptions));

let mcqData=JSON.parse(localStorage.getItem("mcqData"));
let mcqOptions=JSON.parse(localStorage.getItem("mcqOptions"));
let filteredData=[...mcqData];
let currentIndex=-1, answered=false;

// ================== UI ==================
function showQuiz(){
  document.getElementById("quizSection").style.display="block";
  document.getElementById("adminPanel").style.display="none";
  updateCategoryFilter();
  nextQuestion();
}
function showAdmin(){
  document.getElementById("quizSection").style.display="none";
  document.getElementById("adminPanel").style.display="block";
  renderAdmin();
  updateWrongOptions();
  renderOptionList();
  updateCategoryFilter();
}
function shuffleArray(arr){for(let i=arr.length-1;i>0;i--){let j=Math.floor(Math.random()*(i+1));[arr[i],arr[j]]=[arr[j],arr[i]];}return arr;}

// ================== Quiz ==================
function nextQuestion(){
  answered=false;
  if(filteredData.length===0){
    document.getElementById("question").innerText="ржХрзЛржирзЛ ржкрзНрж░рж╢рзНржи ржирзЗржЗ!";
    document.querySelectorAll(".option-btn").forEach(b=>b.disabled=true);
    return;
  }
  currentIndex=(currentIndex+1)%filteredData.length;
  let q=filteredData[currentIndex];
  document.getElementById("question").innerText=q.question;
  let btns=document.querySelectorAll(".option-btn");
  let finalOptions=shuffleArray([...q.options]);
  btns.forEach((b,i)=>{ b.innerText=finalOptions[i]; b.disabled=false; });
  document.getElementById("result").innerText="";
}

function checkAnswer(btn){
  if(answered){ document.getElementById("result").innerText="тЪая╕П ржПржХрж╛ржзрж┐ржХ ржЙрждрзНрждрж░ ржЧрзНрж░рж╣ржгржпрзЛржЧрзНржп ржирзЯ"; return; }
  answered=true;
  let q=filteredData[currentIndex];
  if(btn.innerText===q.answer){
    q.streak++;
    document.getElementById("result").innerHTML=`тЬЕ <span style="color:green">рж╕ржарж┐ржХ</span>`;
    if(q.streak>=15){
      mcqData.splice(mcqData.indexOf(q),1);
      filteredData.splice(currentIndex,1);
      currentIndex--;
      alert("рж╕рзНржЯрзНрж░рж┐ржХ 15 ржкрзВрж░рзНржг, ржкрзНрж░рж╢рзНржи ржбрж┐рж▓рж┐ржЯ рж╣рзЯрзЗржЫрзЗ");
    }
  }else{
    q.streak=0;
    document.getElementById("result").innerHTML=`тЭМ ржнрзБрж▓! рж╕ржарж┐ржХ ржЙрждрзНрждрж░: ${q.answer}`;
  }
  saveData(); renderAdmin();
}

// ================== Option Management ==================
function renderOptionList(){
  let sel=document.getElementById("existingOptions");
  sel.innerHTML="";
  mcqOptions.forEach(opt=>{
    let option = document.createElement("option");
    option.value = opt; option.innerText = opt; sel.appendChild(option);
  });
}
function addOption(){
  let val = document.getElementById("optionText").value.trim();
  if(val && !mcqOptions.includes(val)){
    mcqOptions.push(val); saveOptions();
    renderOptionList(); updateWrongOptions();
    document.getElementById("optionText").value="";
  }
}
function deleteOption(){
  let sel = document.getElementById("existingOptions"); let val = sel.value;
  if(val){ mcqOptions = mcqOptions.filter(o=>o!==val); saveOptions(); renderOptionList(); updateWrongOptions(); }
}
function updateWrongOptions(){
  let sel=document.getElementById("wrongOptions");
  sel.innerHTML="";
  mcqOptions.forEach(opt=>{
    let option = document.createElement("option"); option.value = opt; option.innerText = opt; sel.appendChild(option);
  });
}

// ================== Question Management ==================
function addQuestion(){
  let qText=document.getElementById("questionText").value.trim();
  let cAnswer=document.getElementById("correctAnswer").value.trim();
  let wrongOpts=Array.from(document.getElementById("wrongOptions").selectedOptions).map(o=>o.value);
  let cat=document.getElementById("category").value.trim() || "рж╕рж╛ржзрж╛рж░ржг";
  if(!qText || !cAnswer || wrongOpts.length!==3){ alert("ржкрзНрж░рж╢рзНржи, рж╕ржарж┐ржХ ржЙрждрзНрждрж░ ржПржмржВ рзйржЯрж┐ ржнрзБрж▓ ржЕржкрж╢ржи ржжрж┐рждрзЗ рж╣ржмрзЗ"); return; }
  let options=[cAnswer,...wrongOpts];
  let qObj={question:qText,options:options,answer:cAnswer,category:cat,streak:0};
  mcqData.push(qObj); saveData(); renderAdmin(); applyFilter();
  document.getElementById("questionText").value=""; document.getElementById("correctAnswer").value=""; document.getElementById("category").value="";
}
function renderAdmin(){
  let tbody=document.querySelector("#questionsTable tbody"); tbody.innerHTML="";
  mcqData.forEach((q,i)=>{
    let tr=document.createElement("tr");
    tr.innerHTML=`<td>${i+1}</td>
                  <td>${q.question}</td>
                  <td>${q.answer}</td>
                  <td>${q.category}</td>
                  <td>${q.streak}</td>
                  <td><button class="btn btn-sm btn-danger" onclick="deleteQuestion(${i})">ржбрж┐рж▓рж┐ржЯ</button></td>`;
    tbody.appendChild(tr);
  });
}
function deleteQuestion(idx){
  if(confirm("ржорзБржЫрзЗ ржлрзЗрж▓рждрзЗ ржЪрж╛ржи?")){
    mcqData.splice(idx,1); saveData(); renderAdmin(); applyFilter();
  }
}

// ================== JSON ==================
function toggleJson(){
  let box=document.getElementById("jsonBox");
  let view=document.getElementById("jsonView");
  if(box.style.display==="none"){ view.value=JSON.stringify(mcqData,null,2); box.style.display="block"; }
  else box.style.display="none";
}
function copyJson(){
  document.getElementById("jsonView").select();
  document.execCommand("copy");
  alert("JSON ржХржкрж┐ ржХрж░рж╛ рж╣рзЯрзЗржЫрзЗ");
}

// ================== Filter ==================
function updateCategoryFilter(){
  let sel=document.getElementById("categoryFilter");
  let cats=[...new Set(mcqData.map(q=>q.category))];
  sel.innerHTML='<option value="">рж╕ржм ржХрзНржпрж╛ржЯрж╛ржЧрж░рж┐</option>';
  cats.forEach(c=>{ let opt=document.createElement("option"); opt.value=c; opt.innerText=c; sel.appendChild(opt); });
}
function applyFilter(){
  let cat=document.getElementById("categoryFilter").value;
  filteredData = cat ? mcqData.filter(q=>q.category===cat) : [...mcqData];
  currentIndex=-1; nextQuestion();
}

// ================== Save ==================
function saveData(){ localStorage.setItem("mcqData",JSON.stringify(mcqData)); }
function saveOptions(){ localStorage.setItem("mcqOptions",JSON.stringify(mcqOptions)); }

// ================== Init ==================
showQuiz();
</script>
</body>
</html>