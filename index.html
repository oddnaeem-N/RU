<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MCQ Exam App</title>
<style>
body{font-family:Arial;margin:0;padding:0;background:#f4f4f4;}
.container{max-width:600px;margin:20px auto;padding:20px;background:#fff;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,0.1);}
h2,h3{margin-top:0;}
input,textarea,button{width:100%;margin:5px 0;padding:10px;border-radius:4px;border:1px solid #ccc;}
button{background:#4CAF50;color:#fff;border:none;cursor:pointer;}
button:hover{background:#45a049;}
.question-card{margin:15px 0;padding:10px;border:1px solid #ddd;border-radius:4px;}
.option{display:block;margin:5px 0;}
.hidden{display:none;}
#timer{font-weight:bold;color:red;}
.tab{display:flex;justify-content:space-around;margin-bottom:10px;}
.tab button{width:48%;}
</style>
</head>
<body>
<div class="container">
<h2>üìö MCQ Exam System</h2>

<div class="tab">
  <button onclick="showTab('exam')">Exam</button>
  <button onclick="showTab('admin')">Admin</button>
</div>

<!-- Exam Tab -->
<div id="examTab">
  <div id="userPanel">
    <h3>Exam ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶®‡¶æ‡¶Æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®</h3>
    <input type="text" id="userName" placeholder="‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ">
    <button onclick="startExamWithName()">Start Exam</button>
  </div>
  <div id="examPanel" class="hidden">
    <h3>‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶ö‡¶≤‡¶õ‡ßá <span id="timer">00:00</span></h3>
    <div id="examQuestion"></div>
    <button onclick="prevQ()">‚¨Ö Prev</button>
    <button onclick="nextQ()">Next ‚û°</button>
    <button onclick="submitExam()">Submit</button>
  </div>
  <div id="resultPanel" class="hidden">
    <h3>Result</h3>
    <p>Name: <span id="userLabel"></span></p>
    <p>Correct: <span id="correctCount"></span></p>
    <p>Wrong: <span id="wrongCount"></span></p>
    <p>Skipped: <span id="skippedCount"></span></p>
    <canvas id="resultChart" width="400" height="400"></canvas>
    <button onclick="backToUser()">Back</button>
  </div>
</div>

<!-- Admin Tab -->
<div id="adminTab" class="hidden">
  <h3>Admin Login</h3>
  <input type="text" id="adminUser" placeholder="Username">
  <input type="password" id="adminPass" placeholder="Password">
  <button onclick="loginAdmin()">Login</button>
  <div id="adminPanel" class="hidden">
    <h3>‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶Ø‡ßã‡¶ó/‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</h3>
    <input type="text" id="question" placeholder="‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®">
    <textarea id="options" placeholder="‡¶Ö‡¶™‡¶∂‡¶®‡¶ó‡ßÅ‡¶≤‡ßã ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶® (‡¶ï‡¶Æ‡¶æ ‡¶¶‡¶ø‡ßü‡ßá ‡¶Ü‡¶≤‡¶æ‡¶¶‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®)"></textarea>
    <input type="number" id="answer" placeholder="‡¶∏‡¶†‡¶ø‡¶ï ‡¶Ö‡¶™‡¶∂‡¶®‡ßá‡¶∞ index (0 ‡¶•‡ßá‡¶ï‡ßá ‡¶∂‡ßÅ‡¶∞‡ßÅ)">
    <input type="hidden" id="editIndex">
    <button onclick="saveQuestion()">Save Question</button>

    <h3>‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ</h3>
    <div id="questionList"></div>

    <h3>Backup / Restore</h3>
    <button onclick="exportData()">Export JSON</button>
    <input type="file" id="fileInput" onchange="importData(event)">
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
let questions = JSON.parse(localStorage.getItem("mcqData")) || [];
let currentQ=0, answers=[], timer, timeLeft=60, currentUser="";

// Tab function
function showTab(tab){
  document.getElementById("examTab").style.display = (tab==='exam')?'block':'none';
  document.getElementById("adminTab").style.display = (tab==='admin')?'block':'none';
}

// Admin login
function loginAdmin(){
  const user=document.getElementById("adminUser").value.trim();
  const pass=document.getElementById("adminPass").value;
  if(user==='NA' && pass==='123456'){
    document.getElementById("adminPanel").classList.remove("hidden");
    alert("Admin logged in!");
    loadQuestions();
  } else { alert("Invalid credentials"); }
}

// Admin functions
function saveData(){ localStorage.setItem("mcqData",JSON.stringify(questions)); loadQuestions(); }
function saveQuestion(){
  const q=document.getElementById("question").value;
  const opts=document.getElementById("options").value.split(",");
  const ans=parseInt(document.getElementById("answer").value);
  const editIndex=document.getElementById("editIndex").value;
  if(!q||opts.length<2||isNaN(ans)){ alert("‡¶∏‡¶¨ ‡¶´‡¶ø‡¶≤‡ßç‡¶° ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®!"); return; }
  const newQ={q,options:opts,answer:ans};
  if(editIndex!==""){ questions[editIndex]=newQ; document.getElementById("editIndex").value=""; }
  else questions.push(newQ);
  saveData(); clearForm();
}
function clearForm(){ document.getElementById("question").value=""; document.getElementById("options").value=""; document.getElementById("answer").value=""; }
function editQuestion(i){ const q=questions[i]; document.getElementById("question").value=q.q; document.getElementById("options").value=q.options.join(","); document.getElementById("answer").value=q.answer; document.getElementById("editIndex").value=i; }
function deleteQuestion(i){ if(confirm("Delete?")){ questions.splice(i,1); saveData(); } }
function loadQuestions(){ const list=document.getElementById("questionList"); list.innerHTML=""; questions.forEach((q,i)=>{ const div=document.createElement("div"); div.classList.add("question-card"); div.innerHTML=`<b>${i+1}. ${q.q}</b><br>Options: ${q.options.join(", ")}<br>Answer: ${q.options[q.answer]}<br>
<button onclick="editQuestion(${i})">Edit</button> <button onclick="deleteQuestion(${i})">Delete</button>`; list.appendChild(div); }); }

// Backup/Restore
function exportData(){ const blob=new Blob([JSON.stringify(questions,null,2)],{type:"application/json"}); const url=URL.createObjectURL(blob); const a=document.createElement("a"); a.href=url; a.download="mcq_backup.json"; a.click(); }
function importData(e){ const file=e.target.files[0]; if(!file)return; const reader=new FileReader(); reader.onload=function(ev){ try{ questions=JSON.parse(ev.target.result); saveData(); alert("‡¶°‡ßá‡¶ü‡¶æ ‡¶á‡¶Æ‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶∏‡¶´‡¶≤!"); }catch(err){ alert("Invalid JSON file"); } }; reader.readAsText(file); }

// Exam functions
function startExamWithName(){
  const name = document.getElementById("userName").value.trim();
  if(!name){ alert("Name ‡¶¶‡¶ø‡¶®"); return; }
  currentUser = name;
  document.getElementById("userPanel").classList.add("hidden");
  document.getElementById("examPanel").classList.remove("hidden");
  currentQ=0; answers=new Array(questions.length).fill(null);
  timeLeft=questions.length*60;
  loadExamQ(); startTimer();
}
function loadExamQ(){ const q=questions[currentQ]; let c=document.getElementById("examQuestion"); c.innerHTML=`<h4>${currentQ+1}. ${q.q}</h4>`; q.options.forEach((opt,i)=>{ c.innerHTML+=`<label class="option"><input type="radio" name="q${currentQ}" value="${i}" ${answers[currentQ]===i?'checked':''}> ${opt}</label>`; }); }
function saveAnswer(){ let sel=document.querySelector(`input[name="q${currentQ}"]:checked`); if(sel) answers[currentQ]=parseInt(sel.value); }
function nextQ(){ saveAnswer(); if(currentQ<questions.length-1){currentQ++; loadExamQ();} }
function prevQ(){ saveAnswer(); if(currentQ>0){currentQ--; loadExamQ();} }
function submitExam(){ saveAnswer(); clearInterval(timer); alert("Exam Submitted!"); }
function startTimer(){ updateTimer(); timer=setInterval(()=>{ timeLeft--; updateTimer(); if(timeLeft<=0) submitExam(); },1000); }
function updateTimer(){ let m=Math.floor(timeLeft/60); let s=timeLeft%60; document.getElementById("timer").innerText=`${m}:${s<10?'0'+s:s}`; }
</script>
</body>
</html>
